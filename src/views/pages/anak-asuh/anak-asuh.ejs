<%- include('../../partials/header.ejs', {session : session}) -%>
  <div class="main-content">
    <div class="page-content">
      <div class="container-fluid">
        <!-- start page title -->
        <div class="page-title-box">
          <div class="row align-items-center">
            <div class="col-md-8">
              <h6 class="page-title">Data Anak Asuh</h6>
            </div>
            <% if(session.userType==='ADMINISTRATOR' ) { %>
              <div class="col-md-4">
                <div class="float-end d-none d-md-block">
                  <button type="button" class="btn btn-primary waves-effect waves-light" data-bs-toggle="modal"
                    data-bs-target=".bs-example-modal-center"><i class="fas fa-print"></i> Cetak</button>
                  <a href="/anak-asuh/tambah-anak-asuh">
                    <button type="button" class="btn btn-primary waves-effect waves-light" data-bs-toggle="modal"
                      data-bs-target=".bs-example-modal-center"><i class="fas fa-plus"></i> Tambah</button>
                  </a>
                </div>
              </div>
              <% } %>
          </div>
        </div>
        <!-- end page title -->

        <div class="row">
          <div class="col-12">
            <div class="card">
              <div class="card-body">
                <h4 class="card-title">List Anak Asuh</h4>

                <div class="table-responsive">
                  <table class="table table-editable table-nowrap align-middle table-edits">
                    <thead>
                      <tr>
                        <th>ID</th>
                        <th>Nama Lengkap</th>
                        <th>Jenis Kelamin</th>
                        <th>Tempat Lahir</th>
                        <th>Umur</th>
                        <th>Status</th>
                        <th>Action</th>
                      </tr>
                    </thead>
                    <tbody>
                      <% for(var i=0; i < data.length; i++) { %>
                        <tr data-id="1">
                          <td data-field="id" style="width: 80px">
                            <%= i + 1 %>
                          </td>
                          <td data-field="name">
                            <%=data[i].namaLengkap%>
                          </td>
                          <td data-field="gender">
                            <%=data[i].kelamin%>
                          </td>
                          <td data-field="place-date">
                            <%=data[i].tempatLahir%>
                          </td>
                          <td data-field="age">
                            <%=data[i].umur%>
                          </td>
                          <td data-field="status">
                            <%=data[i].status%>
                          </td>
                          <td style="width: 100px">
                            <a class="btn btn-primary waves-effect waves-light" data-bs-toggle="modal"
                              data-bs-target="#detail<%= data[i].id %>id">
                              <i class="fas fa-eye"></i>
                            </a>
                            <%- include('./popup-detail-anak-asuh.ejs', {detail: data[i], idx: i}) -%>

                              <% if(session.userType==='ADMINISTRATOR' ) { %>
                                <a href="anak-asuh/edit-anak-asuh/<%=data[i].id%>"
                                  class="btn btn-warning waves-effect waves-ligh" title="Edit"
                                  data-bs-toggle="main-content" data-bs-target="#edit<%= data[i].id %>id">
                                  <i class="fas fa-pencil-alt"></i>
                                </a>
                                <button onclick="confirmDelete(<%=data[i].id%>)"
                                  class="btn btn-danger waves-effect waves-ligh" title="Delete"
                                  data-bs-toggle="main-content">
                                  <i class="fas fa-trash-alt"></i>
                                </button>
                                <% } %>
                          </td>
                        </tr>

                        <% } %>
                    </tbody>
                    <!-- end tbody -->
                  </table>
                  <!-- end table -->
                </div>
                <!-- end -->
              </div>
            </div>
          </div>
          <!-- end col -->
        </div>
        <!-- end row -->
      </div>
      <!-- container-fluid -->
    </div>
    <!-- End Page-content -->
  </div>
  <script>
    async function confirmDelete(id) {

      const response = await fetch(`/anak-asuh/${id}`, {
        method: 'DELETE',
      });

      setTimeout(() => {
        window.location.reload();
      }, 500);
    }

  </script>
  <%- include('../../partials/footer.ejs') -%>